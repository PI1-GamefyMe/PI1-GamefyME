<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GamefyME - Realizar atividade</title>
    {% load static %}
    <link href="https://fonts.googleapis.com/css2?family=Jersey+10&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/realizar_atividade.css' %}">
    <script src="{% static 'scripts/realizar_atividade.js' %}"></script>
</head>
<body>
    
    {% include 'header.html'%}

    <div class="app-container">
        <div class="profile-section">
            <div class="avatar-container">
                <div class="avatar">
                    <svg viewBox="0 0 100 100" width="100" height="100">
                        <circle cx="50" cy="40" r="25" fill="#fff"/>
                        <circle cx="50" cy="40" r="15" fill="#bca8e6"/>
                        <ellipse cx="50" cy="80" rx="30" ry="18" fill="#fff"/>
                        <ellipse cx="50" cy="80" rx="22" ry="12" fill="#bca8e6"/>
                    </svg>
                </div>
            </div>
            <div class="profile-info">
                <h2 class="nmusuario">{{ usuario.nmusuario }}</h2>
                <p class="user-date">{{ usuario.dtnascimento|date:"d/m/Y" }}</p>
                <div class="streak-container">
                    <div class="streak-title">Dias consecutivos de atividades completas:</div>
                    <div class="weekdays">
                        <div class="weekday" id="dom">Dom</div>
                        <div class="weekday" id="seg">Seg</div>
                        <div class="weekday" id="ter">Ter</div>
                        <div class="weekday" id="qua">Qua</div>
                        <div class="weekday" id="qui">Qui</div>
                        <div class="weekday" id="sex">Sex</div>
                        <div class="weekday" id="sab">Sab</div>
                    </div>
                    <div class="level">
                        <span class="level-number">Nível: {{ usuario.nivelusuario }}</span>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: {% widthratio usuario.expusuario 1000 100 %}%">
                                <div class="progress-text">
                                    <span style="margin-left: 80px;">{{ usuario.expusuario }}</span><span>/1000</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="btn-perfil">
                <a href="{% url 'atividades:atividade' %}" class="btn-perfil add-task-btn" style="color: #00cc7a;">
                    Add Tarefa
                </a>
                <a href="{% url 'usuarios:main' %}" class="btn-perfil" style="color: #ffe066;">
                    Voltar
                </a>
            </div>
        </div>

        <div class="main-content">
            <div class="atividade-bloco">
                <form action="{% url 'atividades:realizar_atividade' atividade.idatividade %}" method="post" class="form-container">
                    {% csrf_token %}
                    <div class="form-grid">
                        <div>
                            <input type="hidden" name="idusuario" value="{{ usuario.idusuario }}">
                            <div class="form-group">
                                <label for="nmatividade">Atividade</label>
                                <input type="text" id="nmatividade" value="{{ atividade.nmatividade }}" disabled>
                            </div>
                            <div class="form-group">
                                <label for="dsatividade">Descrição</label>
                                <textarea id="dsatividade" disabled>{{ atividade.dsatividade }}</textarea>
                                <div style="text-align: right; color: #fff; font-size: 1rem;">Max 200</div>
                            </div>
                        </div>
                        <div>
                            <div class="form-group">
                                <label for="recorrencia">Recorrência</label>
                                <input type="text" id="recorrencia" value="{{ atividade.get_recorrencia_display }}" disabled>
                            </div>
                            <div class="form-group">
                                <label for="tpestimado">Tempo estimado</label>
                                <div class="input-minutos-wrapper">
                                    <input type="number" id="tpestimado" value="{{ atividade.tpestimado }}" disabled class="input-full">
                                    <span class="minutos-label">minutos</span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="peso">Peso da atividade</label>
                                <input type="text" id="peso" value="{{ atividade.get_peso_display }}" disabled>
                            </div>
                        </div>
                        <input type="hidden" name="inicio" id="inicio">
                        <input type="hidden" name="fim" id="fim">
                        <input type="hidden" name="nrciclo" id="nrciclo">
                    </div>
                    <div class="form-actions">
                        <button id="btn-finalizar" class="action-btn add-task-btn">
                            Concluir Atividade
                        </button>
                        <a href="{% url 'atividades:editar_atividade' atividade.idatividade %}" class="action-btn voltar-task-btn">
                            Editar Atividade
                        </a>
                        <a href="{% url 'atividades:remover_atividade' atividade.idatividade %}" class="action-btn remove-task-btn">
                            <span></span> Cancelar Atividade
                        </a>
                    </div>
                </form>
            </div>
            <div class="pomodoro-bloco">
                <div class="pomodoro-card">
                    <div class="pomodoro-title">Pomodoro</div>
                    <div class="timer">
                        <div class="progress-ring">
                            <svg class="progress" viewBox="0 0 100 100">
                                <circle class="progress-ring-circle" cx="50" cy="50" r="45" />
                            </svg>
                            <div class="timer-display">
                                <span id="minutes">25</span>:<span id="seconds">00</span>
                            </div>
                        </div>
                    </div>
                    <div class="timer-controls">
                        <button id="start-timer" class="timer-btn" title="Iniciar/Pausar">
                            <span id="play-pause-icon">&#9654;</span>
                        </button>
                        <button id="reset-timer" class="timer-btn" title="Reiniciar">
                            &#8635;
                        </button>
                    </div>
                    <div class="timer-mode">
                        <span id="timer-status">Foco</span>
                    </div>
                    <div class="ciclos-counter">
                        <span>Ciclos completos: </span>
                        <span id="ciclos-count">0</span>
                    </div>
                </div>
            </div>
        </div> 
    </div>
</body>
</html>